ST 558 Project 3
================
Rachel Hencher and Yi Ren
2022-11-02

# Load packages

``` r
library(readr)
library(dplyr)
library(caret)
library(ggplot2)
```

# Data

## Read in and subset data

``` r
OnlineNewsPopularity <- read_csv("OnlineNewsPopularity.csv") 
```

    ## Rows: 39644 Columns: 61
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr  (1): url
    ## dbl (60): timedelta, n_tokens_title, n_tokens_content, n_unique_tokens, n_no...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
OnlineNewsPopularity$url <- NULL
channel <- function(x){
  base <- "data_channel_is_"
  data <- paste0(base,x) %>%  
          noquote()
  news <- OnlineNewsPopularity %>% 
          filter(get(data) == 1) %>% 
          select("Number_Title_Words" = "n_tokens_title",
                 "Number_Content_Words" = "n_tokens_content",
                 "Number_Images" = "num_imgs",
                 "Number_Videos" = "num_videos",
                 starts_with("weekday_is"),
                 "Positive_Word_Rate" = "global_rate_positive_words",
                 "Negative_Word_Rate" = "global_rate_negative_words",
                 "Title_Polarity" = "title_sentiment_polarity",
                 "Shares" = "shares")
  
news$Weekday <- as.factor(ifelse(news$weekday_is_monday == 1, "Mon",
                                 ifelse(news$weekday_is_tuesday == 1, "Tues", 
                                        ifelse(news$weekday_is_wednesday == 1, "Weds", 
                                               ifelse(news$weekday_is_thursday , "Thurs",
                                                      ifelse(news$weekday_is_friday == 1, "Fri",
                                                             ifelse(news$weekday_is_saturday == 1, "Sat", "Sun")))))))
news_final <- news %>%
  select(-starts_with("weekday_is"))
return(news_final)
}
```

## Choose an option for the `channel` function argument:

- *lifestyle*: Is the desired data channel lifestyle?  
- *entertainment*: Is the desired data channel entertainment?  
- *bus*: Is the desired data channel business?  
- *socmed*: Is the desired data channel social media?
- *tech*: Is the desired data channel technology?  
- *world*: Is the desired data channel world?

``` r
news_data <- channel("lifestyle")
news_data
```

    ## # A tibble: 2,099 × 9
    ##    Number_Title_Words Number_Content_Words Number_Images Number_Videos
    ##                 <dbl>                <dbl>         <dbl>         <dbl>
    ##  1                  8                  960            20             0
    ##  2                 10                  187             1             0
    ##  3                 11                  103             1             0
    ##  4                 10                  243             0             0
    ##  5                  8                  204             1             0
    ##  6                 11                  315             1             0
    ##  7                 10                 1190            20             0
    ##  8                  6                  374             1             0
    ##  9                 12                  499             1             0
    ## 10                 11                  223             0             0
    ## # … with 2,089 more rows, and 5 more variables: Positive_Word_Rate <dbl>,
    ## #   Negative_Word_Rate <dbl>, Title_Polarity <dbl>, Shares <dbl>, Weekday <fct>

## Split data into train and test

``` r
set.seed(216)
intrain <- createDataPartition(news_data$Shares, p = 0.7, list = FALSE)
training <- news_data[intrain,]
testing <- news_data[-intrain,]
```

# Summarization

``` r
# Summary stats for all variables
summary(training)
```

    ##  Number_Title_Words Number_Content_Words Number_Images     Number_Videos   
    ##  Min.   : 3.000     Min.   :   0.0       Min.   :  0.000   Min.   : 0.000  
    ##  1st Qu.: 8.000     1st Qu.: 298.8       1st Qu.:  1.000   1st Qu.: 0.000  
    ##  Median :10.000     Median : 498.0       Median :  1.000   Median : 0.000  
    ##  Mean   : 9.765     Mean   : 622.4       Mean   :  4.669   Mean   : 0.483  
    ##  3rd Qu.:11.000     3rd Qu.: 793.0       3rd Qu.:  8.000   3rd Qu.: 0.000  
    ##  Max.   :18.000     Max.   :8474.0       Max.   :111.000   Max.   :50.000  
    ##                                                                            
    ##  Positive_Word_Rate Negative_Word_Rate Title_Polarity        Shares      
    ##  Min.   :0.00000    Min.   :0.00000    Min.   :-1.0000   Min.   :    28  
    ##  1st Qu.:0.03475    1st Qu.:0.01040    1st Qu.: 0.0000   1st Qu.:  1100  
    ##  Median :0.04385    Median :0.01575    Median : 0.0000   Median :  1700  
    ##  Mean   :0.04446    Mean   :0.01657    Mean   : 0.1080   Mean   :  3687  
    ##  3rd Qu.:0.05333    3rd Qu.:0.02136    3rd Qu.: 0.2143   3rd Qu.:  3225  
    ##  Max.   :0.12139    Max.   :0.06180    Max.   : 1.0000   Max.   :196700  
    ##                                                                          
    ##   Weekday   
    ##  Fri  :214  
    ##  Mon  :222  
    ##  Sat  :122  
    ##  Sun  :155  
    ##  Thurs:247  
    ##  Tues :223  
    ##  Weds :289

``` r
# Boxplot of weekday vs shares
ggplot(training, aes(x = Weekday, y = Shares)) +
  geom_boxplot(color = "royal blue") +
  scale_y_continuous(trans="log10")
```

![](Project3_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->

``` r
# Scatterplot of title length & polarity vs shares
ggplot(training, aes(x = Number_Title_Words, y=Shares)) + 
  geom_point(aes(color = Title_Polarity))
```

![](Project3_files/figure-gfm/unnamed-chunk-5-2.png)<!-- -->

# Modeling

## Set up cross validation

``` r
control <- trainControl(method = "cv", number = 3)
```

## Linear regression model

``` r
lasso_model <- train(Shares ~ .,
                   data = training,
                   method='lasso',
                   preProcess = c("center", "scale"),
                   trControl = control)
predict(lasso_model$finalModel, type = "coef")
```

    ## $s
    ##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14
    ## 
    ## $fraction
    ##  [1] 0.00000000 0.07692308 0.15384615 0.23076923 0.30769231 0.38461538
    ##  [7] 0.46153846 0.53846154 0.61538462 0.69230769 0.76923077 0.84615385
    ## [13] 0.92307692 1.00000000
    ## 
    ## $mode
    ## [1] "step"
    ## 
    ## $coefficients
    ##    Number_Title_Words Number_Content_Words Number_Images Number_Videos
    ## 0             0.00000               0.0000      0.000000        0.0000
    ## 1             0.00000               0.0000      0.000000      138.5328
    ## 2             0.00000             308.2257      0.000000      446.7585
    ## 3             0.00000             490.5038      0.000000      618.3755
    ## 4             0.00000             547.7259      0.000000      674.4402
    ## 5             0.00000             560.1326      0.000000      687.1379
    ## 6             0.00000             564.4714      0.000000      691.4326
    ## 7             0.00000             584.4576      0.000000      711.4725
    ## 8           -63.54108             642.9014      0.000000      769.9609
    ## 9           -76.29415             653.8666      0.000000      782.2253
    ## 10          -76.97130             654.4843      0.000000      782.8756
    ## 11          -92.05088             668.5817      0.000000      796.8285
    ## 12          -95.23637             674.4743     -6.645061      798.9564
    ## 13         -120.22250             715.3273    -58.164322      812.5976
    ##    Positive_Word_Rate Negative_Word_Rate Title_Polarity WeekdayMon WeekdaySat
    ## 0             0.00000            0.00000       0.000000     0.0000    0.00000
    ## 1             0.00000            0.00000       0.000000     0.0000    0.00000
    ## 2             0.00000            0.00000       0.000000     0.0000    0.00000
    ## 3             0.00000            0.00000       0.000000   180.5782    0.00000
    ## 4             0.00000           59.67134       0.000000   239.6589    0.00000
    ## 5             0.00000           73.20568       0.000000   255.1374    0.00000
    ## 6             0.00000           77.11953      -4.488534   260.2012    0.00000
    ## 7             0.00000           96.07728     -28.125811   288.7892   28.99886
    ## 8             0.00000          152.44431     -96.006716   372.6313  112.01359
    ## 9            11.05990          163.42588    -111.665319   389.8758  129.09151
    ## 10           11.64972          164.00271    -112.471441   391.1050  130.23795
    ## 11           24.59157          174.97297    -130.067141   429.8247  164.35894
    ## 12           27.10524          176.73272    -132.882278   437.1123  171.66419
    ## 13           46.23105          190.11502    -151.339412   556.8847  276.41809
    ##    WeekdaySun WeekdayThurs WeekdayTues WeekdayWeds
    ## 0     0.00000     0.000000     0.00000      0.0000
    ## 1     0.00000     0.000000     0.00000      0.0000
    ## 2     0.00000     0.000000     0.00000      0.0000
    ## 3     0.00000     0.000000     0.00000      0.0000
    ## 4     0.00000     0.000000     0.00000      0.0000
    ## 5    15.76728     0.000000     0.00000      0.0000
    ## 6    21.25706     0.000000     0.00000      0.0000
    ## 7    51.44346     0.000000     0.00000      0.0000
    ## 8   137.34380     0.000000     0.00000      0.0000
    ## 9   154.62991     0.000000     0.00000      0.0000
    ## 10  155.81450     1.258177     0.00000      0.0000
    ## 11  191.80560    41.174412    39.32642      0.0000
    ## 12  199.54596    48.542938    46.63928      0.0000
    ## 13  313.27092   171.675889   166.54379    131.9782

``` r
lasso_model$bestTune
```

    ##   fraction
    ## 1      0.1

## Random forest model

``` r
rf_model <- train(Shares ~ ., 
                  data = training, 
                  method = "rf", 
                  preProcess = c("center", "scale"), 
                  trControl = control, 
                  tuneGrid = expand.grid(mtry = ncol(training) - 1))
rf_model
```

    ## Random Forest 
    ## 
    ## 1472 samples
    ##    8 predictor
    ## 
    ## Pre-processing: centered (13), scaled (13) 
    ## Resampling: Cross-Validated (3 fold) 
    ## Summary of sample sizes: 981, 981, 982 
    ## Resampling results:
    ## 
    ##   RMSE      Rsquared    MAE     
    ##   8700.671  0.00731369  3570.891
    ## 
    ## Tuning parameter 'mtry' was held constant at a value of 8

## Boosted tree model

``` r
gbm_model <- train(Shares ~ .,
                     data = training,
                     method = "gbm",
                     trControl = control,
                     preProcess = c("center", "scale"),
                     verbose = FALSE)
gbm_model
```

    ## Stochastic Gradient Boosting 
    ## 
    ## 1472 samples
    ##    8 predictor
    ## 
    ## Pre-processing: centered (13), scaled (13) 
    ## Resampling: Cross-Validated (3 fold) 
    ## Summary of sample sizes: 982, 981, 981 
    ## Resampling results across tuning parameters:
    ## 
    ##   interaction.depth  n.trees  RMSE      Rsquared    MAE     
    ##   1                   50      8346.207  0.01201501  3327.799
    ##   1                  100      8335.377  0.01248233  3326.437
    ##   1                  150      8350.919  0.00936161  3376.563
    ##   2                   50      8360.525  0.01334884  3372.246
    ##   2                  100      8556.581  0.00639261  3422.041
    ##   2                  150      8537.299  0.01147471  3594.276
    ##   3                   50      8301.126  0.02454587  3389.248
    ##   3                  100      8368.547  0.02191963  3450.836
    ##   3                  150      8396.439  0.02293313  3568.474
    ## 
    ## Tuning parameter 'shrinkage' was held constant at a value of 0.1
    ## 
    ## Tuning parameter 'n.minobsinnode' was held constant at a value of 10
    ## RMSE was used to select the optimal model using the smallest value.
    ## The final values used for the model were n.trees = 50, interaction.depth =
    ##  3, shrinkage = 0.1 and n.minobsinnode = 10.

# Comparison

## Apply model for prediction

``` r
lasso_predict <- predict(lasso_model, newdata = testing)
lasso_predict
```

    ##        1        2        3        4        5        6        7        8 
    ## 3544.303 3578.050 3703.708 3594.129 3555.022 3566.933 3706.289 3528.223 
    ##        9       10       11       12       13       14       15       16 
    ## 3545.692 3764.652 3559.191 3623.708 3557.404 3733.882 3545.692 3592.343 
    ##       17       18       19       20       21       22       23       24 
    ## 3583.211 3685.411 3586.189 3548.670 3594.923 3679.093 3606.239 3566.338 
    ##       25       26       27       28       29       30       31       32 
    ## 3638.596 3556.412 3742.186 3581.027 3592.343 3573.484 3735.040 3570.705 
    ##       33       34       35       36       37       38       39       40 
    ## 3595.320 3639.390 3607.430 3556.412 3600.085 3685.842 3647.728 3589.564 
    ##       41       42       43       44       45       46       47       48 
    ## 3664.800 3542.715 3569.514 3568.720 3644.518 3577.256 3594.725 3731.500 
    ##       49       50       51       52       53       54       55       56 
    ## 3570.109 3674.726 3533.781 3580.829 3630.656 3777.357 3559.588 3662.815 
    ##       57       58       59       60       61       62       63       64 
    ## 3612.591 3503.806 3570.903 3719.953 3644.155 3697.158 3569.911 3579.042 
    ##       65       66       67       68       69       70       71       72 
    ## 3644.353 3551.648 3580.630 3571.697 3609.216 3583.608 3559.985 3542.913 
    ##       73       74       75       76       77       78       79       80 
    ## 3580.630 3594.526 3759.094 3599.291 3697.753 3592.343 3657.256 3549.662 
    ##       81       82       83       84       85       86       87       88 
    ## 3702.682 3763.262 3590.556 3548.273 3692.756 3673.336 3563.360 3699.540 
    ##       89       90       91       92       93       94       95       96 
    ## 3668.175 3554.228 3547.876 3554.030 3620.532 3599.886 3606.239 3887.895 
    ##       97       98       99      100      101      102      103      104 
    ## 3545.494 3651.897 3582.020 3616.363 3535.568 3568.323 3648.687 3547.876 
    ##      105      106      107      108      109      110      111      112 
    ## 3704.900 3686.239 3645.941 3566.735 3642.566 3549.265 3710.424 3693.352 
    ##      113      114      115      116      117      118      119      120 
    ## 3567.132 3557.801 3635.222 3555.022 3710.458 3591.350 3681.078 3723.163 
    ##      121      122      123      124      125      126      127      128 
    ## 3571.499 3618.348 3591.747 3789.863 3584.998 3685.213 3642.368 3630.656 
    ##      129      130      131      132      133      134      135      136 
    ## 3640.184 3584.204 4985.332 3521.871 3690.210 3567.926 3542.913 3625.097 
    ##      137      138      139      140      141      142      143      144 
    ## 3558.596 3673.932 3692.989 3746.587 3709.068 3807.531 4968.855 3707.480 
    ##      145      146      147      148      149      150      151      152 
    ## 3693.153 3627.678 3554.625 3611.201 3584.402 3706.289 3642.368 3817.819 
    ##      153      154      155      156      157      158      159      160 
    ## 3714.196 3583.013 3802.534 3568.323 3569.712 3541.722 3659.440 3659.605 
    ##      161      162      163      164      165      166      167      168 
    ## 3738.845 3579.439 3661.028 3589.961 3882.172 3575.668 4949.634 3657.455 
    ##      169      170      171      172      173      174      175      176 
    ## 3640.780 3650.672 3536.561 3554.625 3585.990 3817.059 3579.439 3583.013 
    ##      177      178      179      180      181      182      183      184 
    ## 4811.071 3643.559 3612.790 3740.002 3556.412 3621.127 3817.190 3664.006 
    ##      185      186      187      188      189      190      191      192 
    ## 3686.636 3677.074 3625.097 3769.581 3631.450 3554.625 3745.561 3751.749 
    ##      193      194      195      196      197      198      199      200 
    ## 3616.760 4170.078 3566.735 3625.296 3558.596 3599.688 3608.025 3543.310 
    ##      201      202      203      204      205      206      207      208 
    ## 3579.241 3661.193 3695.966 3566.338 3846.638 3625.097 3613.981 3653.054 
    ##      209      210      211      212      213      214      215      216 
    ## 3564.154 3551.449 3579.638 3685.247 3633.236 3526.635 3595.122 3618.943 
    ##      217      218      219      220      221      222      223      224 
    ## 3726.504 3664.403 3621.524 3594.328 3569.712 3684.651 3888.722 3824.569 
    ##      225      226      227      228      229      230      231      232 
    ## 3629.068 3698.944 3578.844 3555.419 3619.142 3534.973 3557.007 3543.310 
    ##      233      234      235      236      237      238      239      240 
    ## 3813.288 3637.405 3640.184 3571.697 3607.827 3642.930 3544.303 6176.666 
    ##      241      242      243      244      245      246      247      248 
    ## 3560.779 3563.558 3561.772 3611.400 3977.986 3639.390 3556.610 3525.642 
    ##      249      250      251      252      253      254      255      256 
    ## 3618.149 3847.001 3760.648 3819.209 3684.220 3537.752 3531.002 3544.303 
    ##      257      258      259      260      261      262      263      264 
    ## 3602.864 3840.847 3623.112 3735.040 3525.642 3663.212 3650.870 3655.039 
    ##      265      266      267      268      269      270      271      272 
    ## 3617.157 3719.754 3592.343 3678.100 3573.881 3587.777 3603.261 3592.541 
    ##      273      274      275      276      277      278      279      280 
    ## 3715.619 3552.839 4189.697 3663.013 3615.966 3660.002 3582.219 3791.054 
    ##      281      282      283      284      285      286      287      288 
    ## 3554.228 3714.031 3666.388 3836.678 3789.069 3688.026 3548.670 3570.705 
    ##      289      290      291      292      293      294      295      296 
    ## 3626.685 3663.410 3663.807 3632.244 3609.018 3768.027 3666.354 3675.123 
    ##      297      298      299      300      301      302      303      304 
    ## 4890.080 3732.294 3592.740 3565.146 4781.527 3652.294 3587.181 3550.655 
    ##      305      306      307      308      309      310      311      312 
    ## 3656.264 3574.080 3575.469 3582.814 3531.201 3613.385 3680.482 3568.323 
    ##      313      314      315      316      317      318      319      320 
    ## 3724.320 3546.685 3785.462 3736.628 3643.559 3553.831 3614.378 3561.573 
    ##      321      322      323      324      325      326      327      328 
    ## 3627.877 3620.333 3613.981 3617.951 3771.731 3532.193 3584.998 3562.169 
    ##      329      330      331      332      333      334      335      336 
    ## 3702.120 3581.822 3526.238 3529.811 3564.352 3647.331 3729.084 3601.474 
    ##      337      338      339      340      341      342      343      344 
    ## 3712.608 3734.444 3697.753 3606.636 3682.831 3684.850 3579.638 3654.080 
    ##      345      346      347      348      349      350      351      352 
    ## 3593.931 3565.742 3729.714 3665.793 3562.764 3608.819 4021.658 3555.022 
    ##      353      354      355      356      357      358      359      360 
    ## 3568.323 3583.807 3624.105 3620.730 3621.921 4662.686 3668.175 3573.683 
    ##      361      362      363      364      365      366      367      368 
    ## 3613.187 3521.871 3571.697 3691.565 3556.610 3697.719 3709.068 3694.543 
    ##      369      370      371      372      373      374      375      376 
    ## 3609.812 3683.857 3810.276 3847.199 3702.881 3719.192 3607.231 3693.386 
    ##      377      378      379      380      381      382      383      384 
    ## 3537.752 3804.916 3638.199 4374.280 3558.596 3531.002 3797.010 3640.780 
    ##      385      386      387      388      389      390      391      392 
    ## 3721.178 3730.905 3609.613 3543.906 3693.947 3572.094 3666.190 3718.166 
    ##      393      394      395      396      397      398      399      400 
    ## 3574.080 3730.309 3706.851 3623.311 3574.874 3677.902 3620.929 3981.757 
    ##      401      402      403      404      405      406      407      408 
    ## 3897.191 3610.010 4819.017 3688.423 3546.486 3670.358 3728.920 3574.477 
    ##      409      410      411      412      413      414      415      416 
    ## 3629.663 3783.080 3583.410 3753.138 3611.797 3605.048 3653.485 3616.760 
    ##      417      418      419      420      421      422      423      424 
    ## 3632.045 3854.908 3705.892 3784.072 3695.371 3665.163 3674.329 3712.012 
    ##      425      426      427      428      429      430      431      432 
    ## 3547.876 3584.204 4975.382 3602.467 4305.793 3673.535 3787.084 3526.039 
    ##      433      434      435      436      437      438      439      440 
    ## 3546.486 3547.082 3562.367 3749.962 3668.572 3559.390 4055.870 3705.098 
    ##      441      442      443      444      445      446      447      448 
    ## 3577.256 3617.752 4517.113 3576.263 3735.669 3601.077 3724.915 3578.447 
    ##      449      450      451      452      453      454      455      456 
    ## 3722.766 3586.387 3685.842 3878.797 3630.060 3594.725 3539.935 3700.731 
    ##      457      458      459      460      461      462      463      464 
    ## 3934.744 3771.600 3727.893 3583.608 3713.799 3734.841 3680.284 4115.821 
    ##      465      466      467      468      469      470      471      472 
    ## 3503.806 3566.933 3569.117 3608.819 3622.517 3755.123 3852.525 3570.308 
    ##      473      474      475      476      477      478      479      480 
    ## 3758.697 3809.482 3670.557 3749.333 3583.211 3927.002 3788.473 3599.688 
    ##      481      482      483      484      485      486      487      488 
    ## 3792.608 3697.719 4074.134 3686.205 3555.618 3655.436 3584.799 3715.188 
    ##      489      490      491      492      493      494      495      496 
    ## 3503.806 3582.020 3779.076 3659.208 3702.285 3591.549 3812.692 3583.608 
    ##      497      498      499      500      501      502      503      504 
    ## 3661.227 3610.209 3611.797 3550.655 3549.464 3643.162 3599.092 4454.644 
    ##      505      506      507      508      509      510      511      512 
    ## 3751.715 3704.667 3601.077 3745.561 3733.650 3663.178 3636.810 3547.677 
    ##      513      514      515      516      517      518      519      520 
    ## 3603.062 3681.475 3709.431 3578.844 3614.576 3893.487 3664.403 3774.510 
    ##      521      522      523      524      525      526      527      528 
    ## 3556.610 4006.571 3612.194 3707.877 3612.591 3587.578 3767.562 3566.933 
    ##      529      530      531      532      533      534      535      536 
    ## 3688.820 3610.010 4048.855 3638.993 4053.851 3503.806 3650.672 3550.854 
    ##      537      538      539      540      541      542      543      544 
    ## 3614.973 3598.695 3773.154 5147.517 3546.883 3914.495 3780.102 3585.990 
    ##      545      546      547      548      549      550      551      552 
    ## 3612.591 3794.395 3596.909 3730.275 3615.569 3576.859 3649.117 3630.656 
    ##      553      554      555      556      557      558      559      560 
    ## 3615.966 3767.993 3575.668 3696.363 3555.618 4025.396 3627.644 4398.533 
    ##      561      562      563      564      565      566      567      568 
    ## 3609.812 3691.798 3936.099 3570.308 3588.770 3671.946 3630.854 3647.926 
    ##      569      570      571      572      573      574      575      576 
    ## 3644.750 3695.371 3729.118 3856.893 3588.968 3587.181 3828.307 3657.223 
    ##      577      578      579      580      581      582      583      584 
    ## 3771.367 3576.660 3696.761 3741.624 3687.397 3621.326 3503.806 3676.909 
    ##      585      586      587      588      589      590      591      592 
    ## 3531.796 3503.806 3942.418 3618.546 3737.456 3723.923 3551.449 3627.644 
    ##      593      594      595      596      597      598      599      600 
    ## 3551.846 3617.355 3647.926 3656.627 3630.259 3631.847 3617.157 3681.277 
    ##      601      602      603      604      605      606      607      608 
    ## 3539.538 3740.399 3663.575 3754.097 3824.007 3780.301 3708.076 3728.489 
    ##      609      610      611      612      613      614      615      616 
    ## 3867.845 3572.491 3754.097 3901.790 3682.865 3652.260 3572.094 3596.710 
    ##      617      618      619      620      621      622      623      624 
    ## 3723.923 3601.276 3857.953 3588.968 3646.735 3714.990 3503.806 3684.056 
    ##      625      626      627 
    ## 3681.243 3624.899 4001.875

``` r
rf_predict <- predict(rf_model, newdata = testing)
rf_predict
```

    ##         1         2         3         4         5         6         7         8 
    ##  4221.468  3273.122  3427.648  2274.822  3413.154  2027.369  2589.904  2445.393 
    ##         9        10        11        12        13        14        15        16 
    ##  2168.118  3206.197  2985.987  2340.159  6038.369  4159.975  3275.418  3081.253 
    ##        17        18        19        20        21        22        23        24 
    ##  3201.227  3069.592  2458.674  2173.861  2033.718  2268.009  6655.174  1375.049 
    ##        25        26        27        28        29        30        31        32 
    ##  4280.793  3104.552  4186.048  3641.457  2242.802  2436.842  2329.249  4753.220 
    ##        33        34        35        36        37        38        39        40 
    ##  2591.008  2685.045  1937.383  2817.795  3277.109  3298.568  2476.343  2128.319 
    ##        41        42        43        44        45        46        47        48 
    ##  2375.358  3029.593  2036.326  4097.458  3840.457  2109.230  2432.545  4608.657 
    ##        49        50        51        52        53        54        55        56 
    ##  3880.534  2046.689  3506.785  2954.885  2013.391  4974.815  2480.130  3285.156 
    ##        57        58        59        60        61        62        63        64 
    ##  3790.514  9458.608  7365.534  1843.571  2509.992  3939.489  3501.146  5191.253 
    ##        65        66        67        68        69        70        71        72 
    ##  2622.386  2816.170  3604.324  2888.666  2130.738  2342.773  3315.398  3080.456 
    ##        73        74        75        76        77        78        79        80 
    ##  2810.626  2428.639  2723.841  2483.972  2484.120  2890.685  1739.346  3210.927 
    ##        81        82        83        84        85        86        87        88 
    ##  5464.348  2481.637  3468.908  3093.637  3490.480  2939.560  3090.401  2323.510 
    ##        89        90        91        92        93        94        95        96 
    ##  7367.249  4027.796  3298.188  3038.209  1578.421  3593.887  2462.067  5704.578 
    ##        97        98        99       100       101       102       103       104 
    ##  4813.687  3959.809  2957.316  2915.303  4179.869  4588.148  5930.823  1916.594 
    ##       105       106       107       108       109       110       111       112 
    ##  3340.207  3819.211  2033.828  2172.497  2191.178  3075.455  4977.885  4881.057 
    ##       113       114       115       116       117       118       119       120 
    ##  2300.053  4309.320  2831.958  2976.335  8960.592  2709.972  1933.315  3121.932 
    ##       121       122       123       124       125       126       127       128 
    ##  1961.095  2499.944  2257.119  4552.738  2675.880  2540.510  1664.335  2436.395 
    ##       129       130       131       132       133       134       135       136 
    ##  2714.223  1940.710  5416.055  4327.563  3016.744  2699.781  2900.789  2336.827 
    ##       137       138       139       140       141       142       143       144 
    ##  3368.674  2678.964  3078.379  3892.486  4654.835  3197.365  4356.275  2564.577 
    ##       145       146       147       148       149       150       151       152 
    ##  3322.348  2124.261  2234.426  2831.501  2859.195  2902.495  5181.936  2753.203 
    ##       153       154       155       156       157       158       159       160 
    ##  3934.093  2231.467  2485.513  1949.515  4002.423  4007.294  2320.585  3540.103 
    ##       161       162       163       164       165       166       167       168 
    ##  2433.830  5640.290  2988.340  2728.404  3398.709  2637.594  3731.345  2577.518 
    ##       169       170       171       172       173       174       175       176 
    ##  2699.612  4625.980  4030.674  6929.586  1975.228  5676.694  5278.889  2625.336 
    ##       177       178       179       180       181       182       183       184 
    ##  4707.997  4260.148  2963.867  2910.803  4150.294  2254.824  2984.916  2234.382 
    ##       185       186       187       188       189       190       191       192 
    ##  2252.566  3896.224  3173.596  2396.273  2587.760  2200.290  1619.985  2570.557 
    ##       193       194       195       196       197       198       199       200 
    ##  2691.527  8517.552  2249.589  2594.835  2041.082  2401.104  3665.214  4381.819 
    ##       201       202       203       204       205       206       207       208 
    ##  4469.106  6157.813  3596.795  6497.499  5287.180  3740.748  3802.419  6079.050 
    ##       209       210       211       212       213       214       215       216 
    ##  2179.163  3762.951  3808.324  4143.716  3071.647  3898.699  2990.614  2826.670 
    ##       217       218       219       220       221       222       223       224 
    ##  2029.284  2733.458  2154.958  2046.606  2000.207  2619.228  3916.569  4001.766 
    ##       225       226       227       228       229       230       231       232 
    ##  2687.091  3048.272  4087.789  3941.936  2266.085  7167.324  6940.751  3931.263 
    ##       233       234       235       236       237       238       239       240 
    ##  3858.172  2752.091  2352.534  3361.739  1966.286  5978.601  2599.245 42525.209 
    ##       241       242       243       244       245       246       247       248 
    ##  4277.827  5345.795  6013.683  2029.094  7295.032  3445.417  2739.578  4179.957 
    ##       249       250       251       252       253       254       255       256 
    ##  2213.524  3282.446  1786.834  2543.604  5220.671 11535.718  4609.905  2491.948 
    ##       257       258       259       260       261       262       263       264 
    ##  4980.311  3066.575  2991.867  2394.013  8586.987  2024.533  5526.248  7036.257 
    ##       265       266       267       268       269       270       271       272 
    ##  2741.520  3061.028  3951.232  3729.924  2537.902  3304.179  2130.242  1567.749 
    ##       273       274       275       276       277       278       279       280 
    ##  3320.615  4174.600  5004.212  2517.552  2520.089  4746.227  2383.261  3489.246 
    ##       281       282       283       284       285       286       287       288 
    ##  5691.200 11935.852  2341.284  3276.974  4223.052  2476.067  5473.417  7949.365 
    ##       289       290       291       292       293       294       295       296 
    ##  3275.842  2236.891  6759.937  2637.786  2618.011  1723.371  3269.639  3754.790 
    ##       297       298       299       300       301       302       303       304 
    ##  6154.848  4170.225  3013.824  3513.026  5893.247  2112.497  4027.149  2877.660 
    ##       305       306       307       308       309       310       311       312 
    ##  1768.286  3353.058  3448.301  2565.396  4688.706  3076.525  2614.421  2778.369 
    ##       313       314       315       316       317       318       319       320 
    ##  2243.407  4804.656  3289.520  3280.858  1725.224  3055.402  2503.729  2756.435 
    ##       321       322       323       324       325       326       327       328 
    ##  2407.937  2549.956  2127.140  4590.301  4699.030  5746.679  3156.861  3712.695 
    ##       329       330       331       332       333       334       335       336 
    ##  3296.695  3730.140  6099.824  4895.345  9710.164  1630.799  8156.909  1568.368 
    ##       337       338       339       340       341       342       343       344 
    ##  2759.020  3043.468  3004.674  2851.254  3858.482  3152.714  5563.674  4533.843 
    ##       345       346       347       348       349       350       351       352 
    ##  2409.091  3333.274  3109.928  2885.606  2831.524  2962.025  3889.542  2446.739 
    ##       353       354       355       356       357       358       359       360 
    ##  4950.143  4994.461  2691.910  2113.523  2466.295  3464.610  4512.693  2626.714 
    ##       361       362       363       364       365       366       367       368 
    ##  3298.691  4338.893  1826.532  3253.895  4427.526  2684.217  2290.650  4043.520 
    ##       369       370       371       372       373       374       375       376 
    ##  4497.123  2923.666  2779.204  2202.800  5748.222  3730.420  2598.327  3588.831 
    ##       377       378       379       380       381       382       383       384 
    ##  8577.214  2575.509  2364.262  9411.978  2553.860  4936.614  4282.709  1692.706 
    ##       385       386       387       388       389       390       391       392 
    ##  2029.439  4276.714  2593.392  4211.639  6558.288  3364.850  4961.784  5060.692 
    ##       393       394       395       396       397       398       399       400 
    ##  4526.857  4767.107  3375.854  2563.507  2104.193  2567.866  2738.564  4448.895 
    ##       401       402       403       404       405       406       407       408 
    ##  1882.403  2120.398 24101.093  3171.899  2342.982  4978.879  6008.928  1908.924 
    ##       409       410       411       412       413       414       415       416 
    ##  3031.627  3463.777  5116.764  3397.716  2971.412  3069.945  2534.140  4034.476 
    ##       417       418       419       420       421       422       423       424 
    ##  3751.449  2608.874  2310.527  2191.197  3862.209  3451.609  2394.123  4026.717 
    ##       425       426       427       428       429       430       431       432 
    ##  2152.051  1705.591  9567.521  6124.376  4350.162  4754.171  4289.533  3646.399 
    ##       433       434       435       436       437       438       439       440 
    ##  3901.326  2955.449  3007.976  4044.380  5204.416  4125.336 14379.021  4125.447 
    ##       441       442       443       444       445       446       447       448 
    ## 10370.007  2844.427 11798.408  8502.477  3554.245  1897.410  8825.388  5720.155 
    ##       449       450       451       452       453       454       455       456 
    ##  2741.226  3184.959  3062.505  5090.077  2060.990  5306.896  3553.908  3437.280 
    ##       457       458       459       460       461       462       463       464 
    ##  7831.112  8488.902  6226.299  2849.904  3940.106  5450.453  3551.649  6360.138 
    ##       465       466       467       468       469       470       471       472 
    ##  8848.441  2205.638  2516.293  1815.234  3104.640  2954.835  2530.607  2563.239 
    ##       473       474       475       476       477       478       479       480 
    ##  3972.529  3746.977  6588.633  4132.764  2439.794  3886.152  4150.517  1394.667 
    ##       481       482       483       484       485       486       487       488 
    ##  3009.018  2562.416 16530.807  7257.586  3143.503  4176.642  3228.868  2123.214 
    ##       489       490       491       492       493       494       495       496 
    ##  8399.923  3866.715  6500.957  5630.851  7756.630  3411.261  3407.138  5284.663 
    ##       497       498       499       500       501       502       503       504 
    ##  2749.305  3052.320  3804.526  3422.042  3234.459  5299.124  3308.646  3570.790 
    ##       505       506       507       508       509       510       511       512 
    ##  1942.096  5178.808  2171.590  2106.685  3269.524  4359.397  5413.851  9611.619 
    ##       513       514       515       516       517       518       519       520 
    ##  4225.022  3427.212  2504.900  3490.890  3596.222  3894.916  4506.219  2776.136 
    ##       521       522       523       524       525       526       527       528 
    ##  3870.692  3873.961  4545.149  3524.782  3811.084  2589.008  5599.120  2883.679 
    ##       529       530       531       532       533       534       535       536 
    ##  7046.617  2968.289  7356.426  3252.488  4956.030 10579.919  7692.111  4322.054 
    ##       537       538       539       540       541       542       543       544 
    ##  7968.764  4862.141  7951.312  4657.684  4091.382  5416.909  3676.915  3129.951 
    ##       545       546       547       548       549       550       551       552 
    ##  4391.845  5902.705  1802.382 12588.788  3250.467  2887.713  2558.310  5834.219 
    ##       553       554       555       556       557       558       559       560 
    ##  5205.408  7936.803  5688.629  5352.567  2684.287  4494.876  7766.224  4938.116 
    ##       561       562       563       564       565       566       567       568 
    ##  3037.866  2921.252  2631.165  9370.181  3178.465 20920.372  2256.296  2925.030 
    ##       569       570       571       572       573       574       575       576 
    ##  2089.330  2231.673  5740.965  3050.711  2989.665  3234.740  5040.516  5320.393 
    ##       577       578       579       580       581       582       583       584 
    ##  2884.168  3535.680  2999.118  4725.175  3485.730  3198.788  6756.034  4882.143 
    ##       585       586       587       588       589       590       591       592 
    ##  6092.191  8638.742  3981.489  8749.711  2523.354  9910.918  2399.841  6927.954 
    ##       593       594       595       596       597       598       599       600 
    ##  3637.475  4292.718  3625.356  6538.283  2424.508  3149.250  2349.083  2565.913 
    ##       601       602       603       604       605       606       607       608 
    ##  2529.573  3088.721  2730.296  3584.598  4627.629  2651.289  2821.925  5808.378 
    ##       609       610       611       612       613       614       615       616 
    ##  6246.850  4321.799  2741.864  6380.517  5129.530  4116.898  3336.089  2961.926 
    ##       617       618       619       620       621       622       623       624 
    ##  3348.831  2098.073  3908.549  2673.383  3557.895  5442.055  4499.982  3631.542 
    ##       625       626       627 
    ##  4782.774  1667.015 10016.169

``` r
gbm_predict <- predict(gbm_model, newdata = testing)
gbm_predict
```

    ##   [1]  3933.712  3044.164  3445.746  3107.990  3042.043  2518.611  2974.752
    ##   [8]  4423.720  3208.781  4040.635  3315.497  2954.005  3315.497  5216.656
    ##  [15]  3075.299  3000.647  2603.093  2890.952  2398.257  2860.027  3191.337
    ##  [22]  2723.520  3520.362  2491.046  3248.828  2616.095  2928.044  3741.362
    ##  [29]  3062.655  2723.447  2518.611  3620.228  2728.362  2836.876  2947.420
    ##  [36]  2903.783  3664.275  2572.987  2706.637  2779.078  2858.522  3474.211
    ##  [43]  2895.284  3856.018  3592.558  3083.731  3124.195  5155.193  2893.722
    ##  [50]  3591.777  4255.846  2722.487  2658.380  4337.773  2778.734  2635.930
    ##  [57]  2723.447  5447.897  4330.094  2878.910  2772.179  2803.565  3111.650
    ##  [64]  2823.609  3017.481  3072.469  4797.524  2778.734  3155.991  2890.952
    ##  [71]  2885.103  3591.758  3107.990  2995.101  2995.543  2995.101  2607.329
    ##  [78]  2995.101  3117.592  2903.783  3303.093  2287.012  2725.865  2899.810
    ##  [85]  2963.377  4289.332  2931.215  2358.272  8332.534  3474.211  3169.214
    ##  [92]  3208.781  2778.734  2688.019  2751.184  1956.644  3018.780  3267.911
    ##  [99]  3116.440  3243.096  4215.629  3151.980  3686.384  2948.658  2448.762
    ## [106]  2572.987  2868.600  2658.380  2965.637  3542.921  2995.101  3544.641
    ## [113]  2977.069  3270.661  3168.530  2711.699  6330.674  3183.760  2574.639
    ## [120]  6205.302  2734.978  3082.239  2751.184  2320.868  2778.734  2778.734
    ## [127]  3069.786  2995.101  3646.242  3044.164 12094.424  4640.086  5214.487
    ## [134]  3451.781  2843.703  2884.256  2667.836  3698.439  3179.573  3540.636
    ## [141]  6041.094  4819.732 12047.188  2579.193  2802.311  2931.215  2964.057
    ## [148]  2471.653  2745.015  2808.294  3611.068  5014.441  2963.377  2895.115
    ## [155]  2247.031  2633.608  2751.184  3208.781  3038.801  3550.656  2284.252
    ## [162]  3803.944  3110.852  3107.308  7712.711  2823.609 15847.341  3170.431
    ## [169]  2954.263  5866.171  3910.725  3232.358  2963.377  2990.551  4135.063
    ## [176]  2995.101 12094.424  3153.396  3936.389  3239.339  2952.837  3296.078
    ## [183]  2550.261  2403.357  2723.520  2948.658  3447.405  2535.634  2814.496
    ## [190]  2876.233  2518.611  2582.940  3083.731  5442.729  3039.215  3980.178
    ## [197]  2614.624  3459.337  3593.516  2721.642  2651.631  5083.901  3296.499
    ## [204]  3418.879  2272.960  3107.990  2995.101  4357.056  3044.164  3417.896
    ## [211]  2778.734  2640.172  3688.121  4316.299  3318.814  3532.757  2518.611
    ## [218]  3650.938  2758.555  2518.611  3335.268  2855.811  3542.353  2980.030
    ## [225]  3350.066  2935.962  3476.655  2783.429  2742.071  4181.351  2828.304
    ## [232]  2739.673  3042.001  3011.306  3135.443  2518.611  2895.284  4702.755
    ## [239]  3474.211 12011.077  2977.069  2931.215  3729.823  2778.734  5044.074
    ## [246]  3117.787  2903.783  3750.048  2996.007  6436.725  3336.520  2556.782
    ## [253]  3279.129  6603.529  4560.844  2921.093  3039.286  5918.071  2518.611
    ## [260]  2823.609  4403.715  2600.570  4005.388  4405.071  2778.734  3447.762
    ## [267]  3794.086  3088.383  2751.184  3000.879  3338.983  2614.624  7115.354
    ## [274]  3088.426  5466.331  2552.238  2471.653  3848.346  3037.662  3912.808
    ## [281]  4987.251  7918.295  3644.108  7131.559  3190.882  2556.782  2903.783
    ## [288]  4359.879  2893.731  2668.788  3128.138  2995.101  2751.184  2216.766
    ## [295]  2744.957  3837.067 12094.424  4283.383  4195.210  2796.043  9868.858
    ## [302]  3254.438  2947.198  3933.712  2535.148  2740.524  3147.462  2978.776
    ## [309]  4488.418  3292.024  2247.031  3460.171  2629.853  3316.386  3259.198
    ## [316]  3386.231  2397.060  3776.477  2778.734  2518.611  2980.971  2491.046
    ## [323]  3905.346  3070.983  3528.909  4632.350  3011.306  3028.445  2753.018
    ## [330]  2947.420  5314.544  5252.107  7146.120  2536.828  7098.903  2518.611
    ## [337]  2518.611  3958.288  2539.279  2731.775  2751.184  2396.255  3257.091
    ## [344]  3399.539  3068.633  3572.150  3770.632  3975.146  3150.307  2995.101
    ## [351]  2575.247  3110.300  3471.184  5107.080  2827.066  4180.990  2778.734
    ## [358]  7236.982  5223.158  2509.499  3191.337  4173.092  2491.046  3011.306
    ## [365]  4569.336  2995.101  3912.024  3155.237  4508.181  6681.156  3410.551
    ## [372]  5675.805  4393.999  6788.667  2489.510  2463.397  4470.282  3420.327
    ## [379]  2828.363  9160.607  2398.257  4086.500  3801.466  2509.278  7098.423
    ## [386]  4565.810  3365.197  2903.783  2977.069  2778.734  4327.918  3318.050
    ## [393]  4037.570  4303.940  3857.137  2811.442  2935.020  2436.427  3627.268
    ## [400]  4593.693  2873.549  2774.761 15595.435  3581.525  3206.689  5106.590
    ## [407]  7732.835  2796.043  2584.430  2602.186  3642.909  4961.358  2584.430
    ## [414]  2778.734  3340.271  3701.122  3596.007  3451.781  2431.830  2830.984
    ## [421]  3609.814  4248.494  4104.529  3030.529  2948.658  2778.734 14301.000
    ## [428]  6818.311  6911.105  3800.679  6740.926  3575.690  3990.904  3474.211
    ## [435]  3089.437  2634.051  4469.971  3414.593 17298.441  3281.657  5629.903
    ## [442]  3643.576 16263.693  3734.303  4855.431  2518.611  7364.333  6807.541
    ## [449]  5751.333  3292.846  2673.966  8485.945  2755.927  3386.760  4434.132
    ## [456]  5427.044  7528.114  3629.053  3597.258  3243.286  2734.978  2846.220
    ## [463]  2358.272 14078.662  5806.818  2922.665  3083.731  2947.420  2963.404
    ## [470]  4413.100  2518.611  2863.791  3961.524  2862.894  7552.201  2633.608
    ## [477]  2864.896  3442.536  2807.778  2716.947  3789.168  2847.867 17395.600
    ## [484]  4410.241  3267.131  5173.419  2839.008  3191.337  8316.653  4503.149
    ## [491]  4488.418  4090.737  3845.311  3945.279  3481.043  2810.332  2403.357
    ## [498]  3031.363  3414.059  3059.900  3150.628  3907.094  2528.649  5929.134
    ## [505]  2491.046  5216.907  2528.649  2536.468  4338.765  3559.229  3638.026
    ## [512]  4371.870  3312.855  3382.657  2796.043  3167.334  3299.532  4588.760
    ## [519]  2974.803  3488.542  3924.413  3936.543  3414.059  6329.068  3664.192
    ## [526]  2351.298  4964.316  2611.996  3815.234  2546.506  6378.182  2621.289
    ## [533] 14223.406 10132.894  6494.774  3417.896  7099.860  3716.414  6679.487
    ## [540] 12994.462  3807.181  4525.180  3806.771  2703.255  2920.450  4013.198
    ## [547]  2823.609  3774.276  3526.811  2703.255  3328.697  3961.549  6440.906
    ## [554]  3981.469  2716.947  6350.493  3269.055  3426.850  4041.487  4619.397
    ## [561]  2874.746  2683.211  2659.634  7404.857  2988.499  7060.522  2778.734
    ## [568]  2723.017  2397.060  2539.279  9336.766  3177.207  2995.101  4013.059
    ## [575]  3539.995  4513.885  3210.151  2596.593  2630.532  3540.664  2922.665
    ## [582]  3579.116  4373.903  3138.783  4405.071  5063.061  3484.102  4111.992
    ## [589]  3665.507  3761.451  3169.214  4041.487  3488.797  3454.388  3842.542
    ## [596]  5593.758  2975.314  3368.236  3255.544  2980.030  2898.834  2927.959
    ## [603]  2616.095  3355.398  3911.676  2883.110  2227.445  4402.112  4231.705
    ## [610]  3895.595  2869.729  3606.676  6168.012  4332.505  2634.977  3643.576
    ## [617]  2703.255  2596.593  4826.545  2518.611  2933.823  3199.966  4162.437
    ## [624]  6295.572  3167.436  2542.189 16059.287

## Model performance

``` r
postResample(lasso_predict, obs = testing$Shares)
```

    ##         RMSE     Rsquared          MAE 
    ## 9.650057e+03 5.337779e-03 3.285077e+03

``` r
confusionMatrix(data = testing$Shares, reference = rf_predict)
```

``` r
confusionMatrix(data = testing$Shares, reference = gbm_predict)
```

# Automation
